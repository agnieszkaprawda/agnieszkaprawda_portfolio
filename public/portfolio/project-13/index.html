<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8" />
  <title>Booking.com European landscape analysis</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  
  <meta name="author" content="StaticMania">
  
  <meta name="generator" content="Hugo 0.74.3" />

  <!-- Bootstrap -->
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" />
  <!-- font-awesome -->
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" />
  <!-- Main Stylesheets -->
  
  <link href="/scss/style.min.css" rel="stylesheet" />

  
  <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon" />
</head><body><nav class="navbar navbar-expand-lg site-navigation">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img src="/images/logo.png" alt="logo" />
    </a>
    <button
      class="navbar-toggler collapsed"
      type="button"
      data-toggle="collapse"
      data-target="#sitenavbar"
    >
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>

    <div class="collapse navbar-collapse" id="sitenavbar">
      <ul class="navbar-nav ml-auto main-nav">
         
         
         
          
          <li class="nav-item">
            <a class="nav-link" href="/"
              >Home</a
            >
          </li>
           
         
          
          <li class="nav-item">
            <a class="nav-link" href="/portfolio"
              >Portfolio</a
            >
          </li>
           
         
          
          <li class="nav-item">
            <a class="nav-link" href="/blog"
              >Other Projects</a
            >
          </li>
           
         
          
          <li class="nav-item">
            <a
              class="nav-link btn btn-sm btn-primary btn-sm-rounded"
              href="/contact"
            >
              <span class="btn-area">
                <span data-text="Get in touch">
                  Get in touch
                </span>
              </span>
            </a>
          </li>
           
        
      </ul>
    </div>
  </div>
</nav>
<main>

<section class="site-project-single-section">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        <div class="site-project-single">
          <h1>
            Booking.com European landscape analysis
          </h1>
          <div class="site-project-single-description">
            


<style type="text/css">

.pink { background-color:#fae6e6 ; 
    border-radius: 5px; 
  padding: 20px; color: #000000;}

.blue { background-color:#DFF5F6 ; 
    border-radius: 5px; 
  padding: 20px; color: #000000;}
    
.whitep { background-color:#fffafa ;
    border: 3px gray;
    border-radius: 5px; 
  padding: 20px; color: #000000;}
    
.whiteb { background-color:#f7ffff ;
    border: 3px gray;
    border-radius: 5px; 
  padding: 20px; color: #000000;}

    
</style>
<div id="importing-the-data-set" class="section level3">
<h3>Importing the Data Set</h3>
</div>
<div id="story-time" class="section level3">
<h3>Story Time</h3>
<p>As a team member of Data Analytics Team at Booking.com, I have been asked to gather insights on the mid- to high-end (luxury) hotel market in Europe. I am to present my results to my Team Lead.</p>
<p>#`## Cleaning Data Set global_hotel_chain_sizec</p>
<p>First, let’s have a look at the overall global luxury &amp; upscale hotel market.</p>
<pre class="r blue"><code># let&#39;s have a look on our data set
#describe(global_hotel_chain_size) 
#Remove empty columns and rows
global_hotel_chain_size_clean&lt;-remove_empty(global_hotel_chain_size, which = c(&quot;rows&quot;,&quot;cols&quot;))
#describe(global_hotel_chain_size_clean) </code></pre>
</div>
<div id="cleaning-data-set-hotels_raw" class="section level3">
<h3>Cleaning Data Set hotels_raw</h3>
<pre class="r blue"><code>glimpse(hotels_raw)</code></pre>
<pre class="whiteb"><code>## Rows: 515,738
## Columns: 17
## $ hotel_address                              &lt;chr&gt; &quot;s Gravesandestraat 55 Oos…
## $ additional_number_of_scoring               &lt;dbl&gt; 194, 194, 194, 194, 194, 1…
## $ review_date                                &lt;chr&gt; &quot;8/3/2017&quot;, &quot;8/3/2017&quot;, &quot;7…
## $ average_score                              &lt;dbl&gt; 7.7, 7.7, 7.7, 7.7, 7.7, 7…
## $ hotel_name                                 &lt;chr&gt; &quot;Hotel Arena&quot;, &quot;Hotel Aren…
## $ reviewer_nationality                       &lt;chr&gt; &quot;Russia&quot;, &quot;Ireland&quot;, &quot;Aust…
## $ negative_review                            &lt;chr&gt; &quot;I am so angry that i made…
## $ review_total_negative_word_counts          &lt;dbl&gt; 397, 0, 42, 210, 140, 17, …
## $ total_number_of_reviews                    &lt;dbl&gt; 1403, 1403, 1403, 1403, 14…
## $ positive_review                            &lt;chr&gt; &quot;Only the park outside of …
## $ review_total_positive_word_counts          &lt;dbl&gt; 11, 105, 21, 26, 8, 20, 18…
## $ total_number_of_reviews_reviewer_has_given &lt;dbl&gt; 7, 7, 9, 1, 3, 1, 6, 1, 3,…
## $ reviewer_score                             &lt;dbl&gt; 2.9, 7.5, 7.1, 3.8, 6.7, 6…
## $ tags                                       &lt;chr&gt; &quot;[&#39; Leisure trip &#39;, &#39; Coup…
## $ days_since_review                          &lt;chr&gt; &quot;0 days&quot;, &quot;0 days&quot;, &quot;3 day…
## $ lat                                        &lt;dbl&gt; 52.4, 52.4, 52.4, 52.4, 52…
## $ lng                                        &lt;dbl&gt; 4.92, 4.92, 4.92, 4.92, 4.…</code></pre>
<pre class="r blue"><code>hotels_date_correct&lt;-hotels_raw %&gt;% mutate(review_date=as.Date(review_date,&quot;%d/%m/%Y&quot;)) %&gt;% mutate(country=word(hotel_address,-1,sep=fixed(&quot; &quot;)))
#glimpse(hotels_date_correct)</code></pre>
<pre class="r blue"><code>#Remove empty columns and rows
hotel1&lt;-remove_empty(hotels_date_correct, which = c(&quot;rows&quot;,&quot;cols&quot;))%&gt;%
  filter(!is.na(lat))
#Check for duplicates (visualize bots)
duplicates&lt;-hotel1%&gt;%get_dupes(positive_review, negative_review, hotel_name, reviewer_nationality)
#duplicates
#delete duplicates
hotel2&lt;-hotel1%&gt;%
  distinct(positive_review, negative_review, hotel_name, reviewer_nationality, .keep_all = TRUE)
md.pattern(hotel2,rotate.names = T)</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-6-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="whiteb"><code>##        hotel_address additional_number_of_scoring average_score hotel_name
## 201588             1                            1             1          1
## 307726             1                            1             1          1
## 374                1                            1             1          1
## 549                1                            1             1          1
## 204                1                            1             1          1
## 315                1                            1             1          1
## 50                 1                            1             1          1
## 76                 1                            1             1          1
## 24                 1                            1             1          1
## 39                 1                            1             1          1
##                    0                            0             0          0
##        review_total_negative_word_counts total_number_of_reviews
## 201588                                 1                       1
## 307726                                 1                       1
## 374                                    1                       1
## 549                                    1                       1
## 204                                    1                       1
## 315                                    1                       1
## 50                                     1                       1
## 76                                     1                       1
## 24                                     1                       1
## 39                                     1                       1
##                                        0                       0
##        review_total_positive_word_counts
## 201588                                 1
## 307726                                 1
## 374                                    1
## 549                                    1
## 204                                    1
## 315                                    1
## 50                                     1
## 76                                     1
## 24                                     1
## 39                                     1
##                                        0
##        total_number_of_reviews_reviewer_has_given reviewer_score tags
## 201588                                          1              1    1
## 307726                                          1              1    1
## 374                                             1              1    1
## 549                                             1              1    1
## 204                                             1              1    1
## 315                                             1              1    1
## 50                                              1              1    1
## 76                                              1              1    1
## 24                                              1              1    1
## 39                                              1              1    1
##                                                 0              0    0
##        days_since_review lat lng country positive_review reviewer_nationality
## 201588                 1   1   1       1               1                    1
## 307726                 1   1   1       1               1                    1
## 374                    1   1   1       1               1                    1
## 549                    1   1   1       1               1                    1
## 204                    1   1   1       1               1                    0
## 315                    1   1   1       1               1                    0
## 50                     1   1   1       1               0                    1
## 76                     1   1   1       1               0                    1
## 24                     1   1   1       1               0                    1
## 39                     1   1   1       1               0                    1
##                        0   0   0       0             189                  519
##        negative_review review_date       
## 201588               1           1      0
## 307726               1           0      1
## 374                  0           1      1
## 549                  0           0      2
## 204                  1           1      1
## 315                  1           0      2
## 50                   1           1      1
## 76                   1           0      2
## 24                   0           1      2
## 39                   0           0      3
##                    986      308705 310399</code></pre>
</div>
<div id="europe-vs.-different-continents---luxury-chains-upper-upscale-chains" class="section level3">
<h3>Europe vs. different continents - Luxury Chains, Upper Upscale Chains</h3>
<p>Now I am good to go.</p>
<p>First analysis:</p>
<pre class="r blue"><code> # distribution of all the variables chain scale
data.frame(table(global_hotel_chain_size_clean$chain_scale))</code></pre>
<pre class="whiteb"><code>##                    Var1 Freq
## 1        Economy Chains  141
## 2         Luxury Chains  115
## 3       Midscale Chains  174
## 4 Upper Midscale Chains  225
## 5  Upper Upscale Chains  161
## 6        Upscale Chains  276</code></pre>
<pre class="r blue"><code># changing variables to factors
global_hotel_chain_size_clean$chain_scale &lt;- global_hotel_chain_size_clean$chain_scale %&gt;% factor(levels= c(&quot;Economy Chains&quot;, &quot;Midscale Chains&quot;, &quot;Upper Midscale Chains&quot;,&quot;Upscale Chains&quot;, &quot;Upper Upscale Chains&quot;, &quot;Luxury Chains&quot; ))
 # checking if the data is correct
data.frame(table(global_hotel_chain_size_clean$chain_scale))</code></pre>
<pre class="whiteb"><code>##                    Var1 Freq
## 1        Economy Chains  141
## 2       Midscale Chains  174
## 3 Upper Midscale Chains  225
## 4        Upscale Chains  276
## 5  Upper Upscale Chains  161
## 6         Luxury Chains  115</code></pre>
<pre class="r blue"><code># pivoting the data &amp; cleaning
chain_size_pivot&lt;-global_hotel_chain_size_clean %&gt;% 
  pivot_longer(cols = 5:11, names_to= &quot;region&quot;, values_to= &quot;x&quot;, values_drop_na = TRUE) %&gt;% 
  mutate( region = case_when(
    region== &quot;africa&quot; ~ &quot;Africa&quot;,
    region==&quot;apac&quot; ~ &quot;APAC countries&quot;,
    region== &quot;c_s_america&quot; ~ &quot;Central &amp; South America&quot;,
    region== &quot;europe&quot; ~ &quot;Europe&quot;,
    region== &quot;middle_east&quot; ~ &quot;Middle East&quot;,
    region== &quot;n_america_excl_us&quot; ~ &quot;North America exlc. US&quot;,
    region== &quot;united_states&quot; ~ &quot;United States&quot;,
  )) %&gt;% 
  select(-x)
            
# Luxury Chains across countries
chain_size_pivot_relevant&lt;- chain_size_pivot %&gt;% 
  filter(chain_scale== &quot;Luxury Chains&quot;|| chain_scale== &quot;Upper Upscale Chains&quot; || chain_scale== &quot;Upscale Chains&quot; ) %&gt;% 
  group_by( region) %&gt;% 
  summarise(count=n())
# Upper Upscale Chains across countires
chain_size_pivot %&gt;% 
  filter(chain_scale== &quot;Upper Upscale Chains&quot;) %&gt;% 
  group_by( region) %&gt;% 
  summarise(count=n())</code></pre>
<pre class="whiteb"><code>## # A tibble: 7 x 2
##   region                  count
##   &lt;chr&gt;                   &lt;int&gt;
## 1 Africa                     33
## 2 APAC countries             78
## 3 Central &amp; South America    29
## 4 Europe                     95
## 5 Middle East                34
## 6 North America exlc. US     30
## 7 United States              57</code></pre>
<pre class="r blue"><code>#Upscale Chains across countires
chain_size_pivot %&gt;% 
  filter(chain_scale== &quot;Upscale Chains&quot;) %&gt;% 
  group_by( region) %&gt;% 
  summarise(count=n())</code></pre>
<pre class="whiteb"><code>## # A tibble: 7 x 2
##   region                  count
##   &lt;chr&gt;                   &lt;int&gt;
## 1 Africa                     33
## 2 APAC countries            110
## 3 Central &amp; South America    40
## 4 Europe                    153
## 5 Middle East                37
## 6 North America exlc. US     43
## 7 United States              56</code></pre>
<pre class="r blue"><code># charts showing how big Europe is in these sectors
my_colours &lt;- c(&quot;grey70&quot;, &quot;#2FABE1&quot;)
is_europe&lt;-  chain_size_pivot_relevant%&gt;% 
mutate(
    is_europe = ifelse(region == &quot;Europe&quot;, TRUE, FALSE))
# Chart of the data across all the regions
first_plot&lt;- ggplot(is_europe, aes(x=reorder(region,-count), y=count, fill=is_europe)) +
    geom_bar(stat=&quot;identity&quot;, alpha=0.8)+
theme_minimal() +
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;#043680&quot;,size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;#043680&quot;, face=&quot;bold&quot;, ,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position = &quot;none&quot;)+
    labs(title = &quot; Europe is the most aboundant region \nin Luxury &amp; Upper Upscale Chains&quot;, subtitle= &quot;Number of Luxury, Upper Upscale &amp; Upscale Chains across the regions&quot;, x=&quot;Region&quot;, y=&quot; Number of chians&quot;, caption=&quot;Source: https://www.kaggle.com/ployyyywa/global-hotel-chain-presence&quot;) +
  scale_y_continuous()+
  scale_fill_manual(values = my_colours)+ 
   geom_label(aes(label=count),family = &quot;Montserrat&quot;, fontface=&quot;bold&quot;, color=&quot;grey20&quot;, )
   
first_plot</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-7-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="european-landscape-in-terms-of-chain-types" class="section level3">
<h3>European landscape in terms of chain types</h3>
<pre class="r blue"><code># data on how in Europe the chains are distributed
chain_types_europe&lt;- chain_size_pivot %&gt;% 
  filter(region==&quot;Europe&quot;) %&gt;% 
  group_by( chain_scale) %&gt;% 
  summarise(count=n())
my_colours2 &lt;- c(&quot;grey70&quot;, &quot;#043680&quot;)
is_chain&lt;-  chain_types_europe%&gt;% 
mutate(
    is_chain = ifelse(chain_scale == &quot;Luxury Chains&quot;,  TRUE,
                      ifelse(chain_scale== &quot;Upper Upscale Chains&quot;, TRUE, FALSE)))
# Chart of the data across all the regions
  my_text &lt;- &quot;Upper Upscale + Luxury = 162&quot;
  
ggplot(is_chain, aes(x=reorder(chain_scale,chain_scale), y=count, fill=is_chain)) +
    geom_bar(stat=&quot;identity&quot;, alpha=0.8)+
theme_minimal() +
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;#2FABE1&quot;,size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;#2FABE1&quot;, face=&quot;bold&quot;, ,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position = &quot;none&quot;)+
    labs(title = &quot;Europe seems to be abundant in the chains of our aim &quot;, subtitle= &quot;Number of all the types of chains in Europe&quot;, x=&quot;Hotel sector&quot;, y=&quot; Number of chians&quot;, caption=&quot;Source: https://www.kaggle.com/ployyyywa/global-hotel-chain-presence&quot;) +
  scale_y_continuous()+
  scale_fill_manual(values = my_colours2)+ 
   geom_label(aes(label=count),family = &quot;Montserrat&quot;, fontface=&quot;bold&quot;, color=&quot;white&quot;, )+
   annotation_custom(grid.text(my_text, x=0.85,  y=0.7,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize=8.5, col=&quot;#2FABE1&quot;, fontface=&quot;bold&quot;)))</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-8-1.png" width="648" style="display: block; margin: auto;" /><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-8-2.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="average-rating-of-hotels-by-country" class="section level3">
<h3>Average rating of hotels by country</h3>
<pre class="r blue"><code>#7.hotels with highest ratings (possible: combined with location)
#average rating of hotels by country
hotel3&lt;-hotel2 %&gt;%
  distinct(hotel_name,average_score,country)%&gt;%
  select(country,average_score) 
  
my_colours3 &lt;- c(&quot;white&quot;, &quot;#2FABE1&quot;)
is_france&lt;-  hotel3%&gt;% 
mutate(
    is_france = ifelse(country == &quot;France&quot;,  TRUE, FALSE)) %&gt;% 
   mutate(country=recode(country, &quot;Kingdom&quot; = &quot;United Kingdom&quot;))
ggplot(is_france, aes(x=average_score,y=reorder(country,average_score),fill=is_france))+
  geom_violin()+
  geom_boxplot(width=0.1)+
  theme_minimal() +
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;black&quot;,size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;#043680&quot;, face=&quot;bold&quot;, ,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position = &quot;none&quot;)+
    labs(title = &quot;France has the highest median rating&quot;, subtitle= &quot;Distribution of average ratings of hotels across 6 selected countries&quot;, x=&quot;Average rating of hotels&quot;, y=&quot;Country&quot;, caption=&quot;Source: https://www.kaggle.com/ployyyywa/global-hotel-chain-presence&quot;) +
  scale_fill_manual(values = my_colours3)</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-9-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="hotels-of-excellent-ratings-by-country" class="section level3">
<h3>Hotels of excellent ratings, by country</h3>
<pre class="r blue"><code>##hotels with highest ratings
##choose all hotels &gt; 8/8.5/9
hotel4&lt;-hotel3%&gt;%
  filter(average_score&gt;=9)%&gt;%
  group_by(country)%&gt;%
  summarise(count=n())%&gt;%
  mutate(is_best=ifelse(country==&quot;Kingdom&quot;|country==&quot;France&quot;,1,0))
ggplot(hotel4,aes(x=reorder(country,count),y=count,fill=factor(is_best)))+
  geom_col(position=&quot;dodge&quot;)+
  theme_minimal() +
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;black&quot;,size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;#043680&quot;, face=&quot;bold&quot;, ,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7, angle=30, hjust=1),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position=&quot;none&quot;)+
    labs(title = &quot;UK &amp; France dominate hotels with &gt;9 average rating&quot;, subtitle= &quot;Number of &gt;9 rating hotels in 6 selected countries&quot;, x=&quot;Country&quot;, y=&quot;No. of hotels with rating &gt;9&quot;, caption=&quot;Source: https://www.kaggle.com/ployyyywa/global-hotel-chain-presence&quot;)+
  scale_fill_manual(values=c(&quot;grey80&quot;,&quot;#2FABE1&quot;)) +
  coord_flip()</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-10-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="proportion-of-top-5-reviewer-nationalities-per-country" class="section level3">
<h3>Proportion of Top 5 Reviewer Nationalities per Country</h3>
<pre class="r blue"><code>maggiehoteldata &lt;- hotel2 %&gt;% mutate(country=recode(
  country, `Kingdom`= &quot;United Kingdom&quot;)) %&gt;%  # change Kingdom to United Kingdom to allow matching
  rename(hotelcountry = country)
# UK
## get counts and proportions of reviewer nationalities 
ukdata &lt;- maggiehoteldata %&gt;% 
  filter(hotelcountry == &quot;United Kingdom&quot;) %&gt;%
  group_by(reviewer_nationality) %&gt;%
  summarise(countreviewernat = n(), 
            propreviewernat = countreviewernat / 261509) %&gt;%
  arrange(desc(countreviewernat)) %&gt;%
  mutate(hotelcountry = &quot;United Kingdom&quot;) %&gt;%
  slice(1:5)
# ukdata %&gt;% 
  # summarise(sumcount = sum(countreviewernat))
# 261509 total reviews
# Netherlands
## get counts and proportions of reviewer nationalities 
nldata &lt;- maggiehoteldata %&gt;% 
  filter(hotelcountry == &quot;Netherlands&quot;) %&gt;%
  group_by(reviewer_nationality) %&gt;%
  summarise(countreviewernat = n(),
            propreviewernat = countreviewernat / 57119) %&gt;%
  arrange(desc(countreviewernat)) %&gt;%
  mutate(hotelcountry = &quot;Netherlands&quot;) %&gt;%
  slice(1:5)
# nldata %&gt;% 
  # summarise(sumcount = sum(countreviewernat))
# 57119 total reviews 
# Austria
## get counts and proportions of reviewer nationalities 
ausdata &lt;- maggiehoteldata %&gt;%
  filter(hotelcountry == &quot;Austria&quot;) %&gt;%
  group_by(reviewer_nationality) %&gt;%
  summarise(countreviewernat = n(),
            propreviewernat = countreviewernat / 36241) %&gt;%
  arrange(desc(countreviewernat)) %&gt;%
  mutate(hotelcountry = &quot;Austria&quot;) %&gt;%
  slice(1:5)
# ausdata %&gt;% 
 #  summarise(sumcount = sum(countreviewernat))
# 36241 total reviews 
# Spain
## get counts and proportions of reviewer nationalities 
spaindata &lt;- maggiehoteldata %&gt;%
  filter(hotelcountry == &quot;Spain&quot;) %&gt;%
  group_by(reviewer_nationality) %&gt;%
  summarise(countreviewernat = n(),
            propreviewernat = countreviewernat / 59895) %&gt;%
  arrange(desc(countreviewernat)) %&gt;%
  mutate(hotelcountry = &quot;Spain&quot;) %&gt;%
  slice(1:5)
 # spaindata %&gt;% 
   # summarise(sumcount = sum(countreviewernat))
# 59895 total reviews 
# France
## get counts and proportions of reviewer nationalities 
francedata &lt;- maggiehoteldata %&gt;%
  filter(hotelcountry == &quot;France&quot;) %&gt;%
  group_by(reviewer_nationality) %&gt;%
  summarise(countreviewernat = n(),
            propreviewernat = countreviewernat / 59011 ) %&gt;%
  arrange(desc(countreviewernat)) %&gt;%
  mutate(hotelcountry = &quot;France&quot;) %&gt;%
  slice(1:5)
# francedata %&gt;% 
   # summarise(sumcount = sum(countreviewernat))
# 59011  total reviews 
# Italy
## get counts and proportions of reviewer nationalities 
italydata &lt;- maggiehoteldata %&gt;%
  filter(hotelcountry == &quot;Italy&quot;) %&gt;%
  group_by(reviewer_nationality) %&gt;%
  summarise(countreviewernat = n(),
            propreviewernat = countreviewernat / 37170) %&gt;%
  arrange(desc(countreviewernat)) %&gt;%
  mutate(hotelcountry = &quot;Italy&quot;) %&gt;%
  slice(1:5)
# italydata %&gt;% 
   # summarise(sumcount = sum(countreviewernat))
# 37170 total reviews
# Combine all of the above 
top5reviewernat &lt;- rbind(ukdata,
                         nldata,
                         spaindata,
                         francedata,
                         italydata,
                         ausdata)
 countrylevels &lt;- names(sort(tapply(top5reviewernat$propreviewernat, # create levels to have stacked bar chart according to size not alphabetical order 
                                    top5reviewernat$reviewer_nationality,
                                    sum)))
# Code for barplot 
 
stackedbarplot &lt;- ggplot(top5reviewernat, aes(x = hotelcountry, y = propreviewernat, 
                            fill = factor(reviewer_nationality, levels = countrylevels))) +
  geom_bar(stat = &quot;identity&quot;) + 
  scale_fill_manual(values = c(&quot;#810f7c&quot;, &quot;#8856a7&quot;, &quot;#8c96c6&quot;, &quot;#9ebcda&quot;, &quot;#bfd3e6&quot;, &quot;#edf8fb&quot;,
                              &quot;#ccebc5&quot;, &quot;#a8ddb5&quot;, &quot;#7bccc4&quot;, &quot;#43a2ca&quot;, &quot;#0868ac&quot;, &quot;darkblue&quot;)) +
  labs(title = &quot;Brits take over as Majority Reviewers&quot;,
       subtitle = &quot;Proportion of Top 5 Reviewer Nationalities per Country&quot;,
      y = &quot;Proportion of Total Reviews&quot;,
      x = &quot; &quot;) +
  theme(legend.title = element_blank(),
panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        plot.title = element_text(size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(face=&quot;plain&quot;, ,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7))
 
stackedbarplot</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-11-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="region-and-subregion-reviers-background" class="section level3">
<h3>Region and subregion reviers’ background</h3>
<div id="creating-variables" class="section level4">
<h4>Creating variables</h4>
<pre class="r blue"><code>glimpse(hotel2)</code></pre>
<pre class="whiteb"><code>## Rows: 510,945
## Columns: 18
## $ hotel_address                              &lt;chr&gt; &quot;s Gravesandestraat 55 Oos…
## $ additional_number_of_scoring               &lt;dbl&gt; 194, 194, 194, 194, 194, 1…
## $ review_date                                &lt;date&gt; 2017-03-08, 2017-03-08, N…
## $ average_score                              &lt;dbl&gt; 7.7, 7.7, 7.7, 7.7, 7.7, 7…
## $ hotel_name                                 &lt;chr&gt; &quot;Hotel Arena&quot;, &quot;Hotel Aren…
## $ reviewer_nationality                       &lt;chr&gt; &quot;Russia&quot;, &quot;Ireland&quot;, &quot;Aust…
## $ negative_review                            &lt;chr&gt; &quot;I am so angry that i made…
## $ review_total_negative_word_counts          &lt;dbl&gt; 397, 0, 42, 210, 140, 17, …
## $ total_number_of_reviews                    &lt;dbl&gt; 1403, 1403, 1403, 1403, 14…
## $ positive_review                            &lt;chr&gt; &quot;Only the park outside of …
## $ review_total_positive_word_counts          &lt;dbl&gt; 11, 105, 21, 26, 8, 20, 18…
## $ total_number_of_reviews_reviewer_has_given &lt;dbl&gt; 7, 7, 9, 1, 3, 1, 6, 1, 3,…
## $ reviewer_score                             &lt;dbl&gt; 2.9, 7.5, 7.1, 3.8, 6.7, 6…
## $ tags                                       &lt;chr&gt; &quot;[&#39; Leisure trip &#39;, &#39; Coup…
## $ days_since_review                          &lt;chr&gt; &quot;0 days&quot;, &quot;0 days&quot;, &quot;3 day…
## $ lat                                        &lt;dbl&gt; 52.4, 52.4, 52.4, 52.4, 52…
## $ lng                                        &lt;dbl&gt; 4.92, 4.92, 4.92, 4.92, 4.…
## $ country                                    &lt;chr&gt; &quot;Netherlands&quot;, &quot;Netherland…</code></pre>
<pre class="r blue"><code>hotel_review_nationality&lt;- hotel2 %&gt;%  #merging main table with countries and continents of reviwers&#39; origin
  left_join(country_continent, by=c(&quot;reviewer_nationality&quot;=&quot;name&quot;)) %&gt;% 
  drop_na(reviewer_nationality, region)
reviews_by_region&lt;- hotel_review_nationality  %&gt;% #creating summary for regions
  group_by(region) %&gt;% 
  summarise(avg_review= mean(reviewer_score),
            avg_no_positive= mean(review_total_positive_word_counts),
            avg_no_negative= mean(review_total_negative_word_counts)) %&gt;% 
  arrange(desc(avg_review))
reviews_by_subregion&lt;- hotel_review_nationality  %&gt;%  #creating summary for subregions
  group_by(region,sub_region) %&gt;% 
  summarise(avg_review= mean(reviewer_score),
            avg_no_positive= mean(review_total_positive_word_counts),
            avg_no_negative= mean(review_total_negative_word_counts)) %&gt;% 
  arrange(desc(avg_review))</code></pre>
</div>
</div>
<div id="reviewers-origin-by-region" class="section level3">
<h3>Reviewers’ origin by region</h3>
<pre class="r blue"><code># pivoting regions
reviews_by_region_pivot&lt;- reviews_by_region %&gt;% 
  pivot_longer(cols = 3:4, names_to= &quot;type_review&quot;, values_to= &quot;score&quot;, values_drop_na = TRUE) # pivoted dataframe
reviews_by_region_pivot$type_review&lt;- reviews_by_region_pivot$type_review %&gt;%  factor(levels= c(&quot;avg_no_negative&quot;, &quot;avg_no_positive&quot;)) # creating avg no of positive &amp; negative words per region + average review score per region
# creating a cool chart
reviews_by_region_pivot &lt;- reviews_by_region_pivot%&gt;%
  mutate(score_chart = ifelse(type_review == &quot;avg_no_positive&quot;, 
                                 score,
                                 -1*score)) %&gt;% 
  mutate(is_extreme = ifelse(score_chart&gt;20, &quot;1&quot;,
                             ifelse(score_chart&lt; -19, &quot;2&quot;,
                                    ifelse(score_chart&gt;-19 &amp; score_chart &lt;0, &quot;3&quot;, &quot;4&quot;))))

my_colours_positive&lt;- c(&quot;#45B05F&quot;, &quot;tomato&quot;,&quot;#FFBAAD&quot;,&quot;#A8DDB5&quot;) # scale for the chart
 
  my_text1r &lt;- &quot;Negative&quot;
    my_text2r &lt;- &quot;Positive&quot;
    my_text3r &lt;- &quot;Average review score&quot;
my_grob = grid.text(my_text1r, x=0.43,  y=0.83,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize= 11, col=&quot;tomato&quot;, fontface=&quot;bold&quot;))
my_grob2 = grid.text(my_text2r, x=0.54,  y=0.83,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize= 11, col=&quot;#F1FFEB&quot;, fontface=2))
my_grob3 = grid.text(my_text3r, x=0.68,  y=0.95,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize= 8, col=&quot;black&quot;, fontface=2))</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-13-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r blue"><code>quartz()
# negative and positive
plot_region_reviews&lt;-reviews_by_region_pivot %&gt;%
  ggplot(aes(x = reorder(region,avg_review), fill=is_extreme))+
  geom_bar(aes(y = score_chart),stat = &quot;identity&quot;)+
  coord_flip() +
  theme_minimal()+
  geom_text(aes(y=avg_review, label=round(avg_review,1)),family = &quot;Montserrat&quot;, fontface=&quot;bold&quot;, colour=&quot;black&quot;)+
  scale_y_continuous(breaks=seq(-20,20,5)) +
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;grey20&quot;,size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;grey40&quot;, face=&quot;plain&quot;,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position = &quot;none&quot;)+
    labs(title = &quot;The most criticising guests come from Europe,\nthe most positive come from Australia&quot;, subtitle= &quot;Number of positive and negative words per review per continent and average review score&quot;, x= &quot;Region&quot;, y= &quot;Average number of positive/negative words in a review&quot;, caption=&quot;Source: https://www.kaggle.com/ployyyywa/global-hotel-chain-presence&quot;) +
  scale_fill_manual(values = my_colours_positive) +
  scale_y_continuous(labels=abs)+
   geom_hline(yintercept = -8, linetype=&quot;dashed&quot;, 
                color = &quot;tomato&quot;, size=0.8)+
  geom_hline(yintercept = 19.5, linetype=&quot;dashed&quot;, 
                color = &quot;#45B05F&quot;, size=0.8)

plot_region_reviews +annotation_custom(my_grob) + annotation_custom(my_grob2)+annotation_custom(my_grob3) </code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-13-2.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="reviewers-origin-by-subregion" class="section level3">
<h3>Reviewers’ origin by Subregion</h3>
<pre class="r blue"><code>reviews_by_subregion_pivot&lt;- reviews_by_subregion %&gt;% 
  pivot_longer(cols = 4:5, names_to= &quot;type_review&quot;, values_to= &quot;score&quot;, values_drop_na = TRUE) # pivoted dataframe
reviews_by_subregion_pivot$type_review&lt;- reviews_by_subregion_pivot$type_review %&gt;%  factor(levels= c(&quot;avg_no_negative&quot;, &quot;avg_no_positive&quot;)) # creating avg no of positive &amp; negative words per region + average review score per subregion
reviews_by_subregion_pivot &lt;- reviews_by_subregion_pivot%&gt;%
  mutate(score_chart = ifelse(type_review == &quot;avg_no_positive&quot;,
                                 score,
                                 -1*score)) %&gt;% 
  mutate(is_extreme = ifelse(score_chart&gt;17.5, &quot;1&quot;,
                             ifelse(score_chart&lt; -17.5, &quot;2&quot;,
                                    ifelse(score_chart&gt;-17.5 &amp; score_chart &lt;0, &quot;3&quot;, &quot;4&quot;))))

plot_subregion_reviews &lt;-reviews_by_subregion_pivot %&gt;%
  ggplot(aes(x = reorder(sub_region,avg_review), fill = is_extreme))+
  geom_bar(aes(y = score_chart),stat = &quot;identity&quot;)+
  coord_flip() +
  geom_text(aes(y=avg_review, label=round(avg_review,1)),family = &quot;Montserrat&quot;, fontface=&quot;bold&quot;, colour=&quot;black&quot;)+
  scale_y_continuous(breaks=seq(-20,20,5)) +
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;grey20&quot;,size=10,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;grey40&quot;, face=&quot;plain&quot;, ,size= 8,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;bold&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position = &quot;none&quot;)+
    labs(title = &quot;Guests from Europe &amp; North America seem to be \nmost influencial ones and shaping the opinion&quot;, subtitle= &quot;Average number of positive/negative words in a review and average review score&quot;, x= &quot;Region&quot;, y= &quot;Average number of positive/negative words in a review&quot;, caption=&quot;Source: https://www.kaggle.com/ployyyywa/global-hotel-chain-presence&quot;) +
  scale_fill_manual(values = my_colours_positive) +
  scale_y_continuous(labels=abs)+
   geom_hline(yintercept = -17.5, linetype=&quot;dashed&quot;, 
                color = &quot;tomato&quot;, size=0.8)+
  geom_hline(yintercept = 17.5, linetype=&quot;dashed&quot;, 
                color = &quot;#45B05F&quot;, size=0.8)
     my_text1s &lt;- &quot;Negative&quot;
    my_text2s &lt;- &quot;Positive&quot;
    my_text3s &lt;- &quot;Average \nreview score&quot;
my_grobs1 = grid.text(my_text1s, x=0.425,  y=0.85,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize= 8, col=&quot;tomato&quot;, fontface=&quot;bold&quot;))
my_grobs2 = grid.text(my_text2s, x=0.545,  y=0.85,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize= 8, col=&quot;#3FA259&quot;, fontface=2))
my_grobs3 = grid.text(my_text3s, x=0.77,  y=0.94,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize= 9, col=&quot;black&quot;, fontface=2))</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-14-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r blue"><code> plot_subregion_reviews + annotation_custom(my_grobs1) + annotation_custom(my_grobs2)+annotation_custom(my_grobs3)</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-14-2.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="creating-wordclouds-with-most-popular-positive-negative-words" class="section level3">
<h3>Creating wordclouds with most popular positive/ negative words</h3>
<div id="preparing-dataset" class="section level4">
<h4>Preparing dataset</h4>
<pre class="r blue"><code>hotelcloud&lt;-hotel2[!is.na(hotel2$positive_review), ]
hotelcloud&lt;-hotel2[!is.na(hotel2$negative_review), ]</code></pre>
<pre class="r blue"><code>hotelcloud2&lt;-hotelcloud
#clean reviews and select only those with useful information
hotelcloud3&lt;-hotelcloud2 %&gt;% 
  filter(sapply(strsplit(positive_review, &quot; &quot;), length)&gt;3) %&gt;% 
  filter(sapply(strsplit(negative_review, &quot; &quot;), length)&gt;3)
#randomly select 6000 data to visualize
hotelcloud4&lt;-hotelcloud3[sample(nrow(hotelcloud3), 6000), ]
rm(hotelcloud3,hotelcloud2)
#build corpus
library(tm)
review_pos &lt;- Corpus(VectorSource(hotelcloud4$positive_review)) 
review_neg &lt;- Corpus(VectorSource(hotelcloud4$negative_review)) 
#skip the words: room and hotel, cuz they dont give useful information
words &lt;- c(&quot;room&quot;,&quot;hotel&quot;)
review_pos &lt;- tm_map(review_pos, removeWords, words)
review_neg &lt;- tm_map(review_neg, removeWords, words)
#count frequency
DTM_pos &lt;- DocumentTermMatrix(review_pos, control = list(
            tolower = TRUE,
            removeNumbers = TRUE,
            stopwords = TRUE,
            removePunctuation = TRUE,
            stripWhitespace = TRUE))
dim(DTM_pos) </code></pre>
<pre class="whiteb"><code>## [1] 6000 5512</code></pre>
<pre class="r blue"><code>DTM_neg &lt;- DocumentTermMatrix(review_neg, control = list(
            tolower = TRUE,
            removeNumbers = TRUE,
            stopwords = TRUE,
            removePunctuation = TRUE,
            stripWhitespace = TRUE))
inspect(DTM_neg) </code></pre>
<pre class="whiteb"><code>## &lt;&lt;DocumentTermMatrix (documents: 6000, terms: 7458)&gt;&gt;
## Non-/sparse entries: 74438/44673562
## Sparsity           : 100%
## Maximal term length: 21
## Weighting          : term frequency (tf)
## Sample             :
##       Terms
## Docs   bathroom bed bit breakfast didn little one rooms small staff
##   1438        0   1   0         1    0      0   0     1     1     0
##   2200        0   0   0         0    0      0   0     0     0     2
##   3412        0   0   0         4    1      0   2     0     0     0
##   3561        1   1   0         0    0      1   1     3     0     1
##   4482        0   1   0         0    3      1   1     3     0     1
##   4703        3   3   0         0    1      0   0     8     2     0
##   4771        0   2   1         0    0      1   0     0     0     0
##   4942        1   3   0         3    0      0   1     1     3     2
##   5658        0   0   0         0    0      1   2     1     0     0
##   5754        0   0   0         0    0      0   0     0     0     2</code></pre>
<pre class="r blue"><code>rm(review_neg,review_pos)</code></pre>
</div>
<div id="positive-wordcloud" class="section level4">
<h4>Positive wordcloud</h4>
<pre class="r blue"><code>##Positive wordcloud
#convert to tibble
m &lt;- as.matrix(DTM_pos)
DTM_tbl &lt;- as_tibble(m)
#rm (m,hotel3,DTM_neg,DTM_pos,review_pos,review_neg,DTM_tbl,wordCountDoc_pos)
DTM_pos_tidy &lt;- pivot_longer(DTM_tbl, cols = everything(), names_to = &quot;word&quot;, values_to = &quot;wordCount&quot;)
# Order by freq
wordCountDoc_pos &lt;- DTM_pos_tidy %&gt;%  
        group_by(word) %&gt;% 
        summarise(total_pos = sum(wordCount)) %&gt;% 
        arrange(desc(total_pos)) 
print(wordCountDoc_pos %&gt;% top_n(5))</code></pre>
<pre class="whiteb"><code>## # A tibble: 5 x 2
##   word      total_pos
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 staff          2541
## 2 location       2439
## 3 good           1729
## 4 great          1477
## 5 breakfast      1190</code></pre>
<pre class="r blue"><code>#wordcloud
library(wordcloud)
library(wordcloud2)
wordcloud(words = wordCountDoc_pos$word, 
          freq = wordCountDoc_pos$total_pos, 
          max.words = 150,
          scale = c(3, 0.5), 
          random.order = FALSE,
          rot.per = 0.35,
          colors = c(&quot;#ccebc5&quot;, &quot;#7bccc4&quot;, &quot;#7fbf7b&quot;,&quot;#4eb3d3&quot;,&quot;#8c6bb1&quot;,&quot;#810f7c&quot;))+
  title(main = &quot;Most Frequent Words in Positive Reviews&quot;, col.main = &quot;#810f7c&quot;, size = 8, family=&quot;Montserrat&quot;, face = &quot;bold&quot;)</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-16-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="whiteb"><code>## integer(0)</code></pre>
</div>
<div id="negatvie-wordcloud" class="section level4">
<h4>Negatvie wordcloud</h4>
<pre class="r blue"><code>##Negatvie wordcloud
#convert to tibble
m &lt;- as.matrix(DTM_neg)
DTM_tbl &lt;- as_tibble(m)
#rm (m,hotel3,DTM_neg,DTM_pos,review_pos,review_neg,DTM_tbl,wordCountDoc_pos)
DTM_neg_tidy &lt;- pivot_longer(DTM_tbl, cols = everything(), names_to = &quot;word&quot;, values_to = &quot;wordCount&quot;)
# Order by freq
wordCountDoc_neg &lt;- DTM_neg_tidy %&gt;%  
        group_by(word) %&gt;% 
        summarise(total_neg = sum(wordCount)) %&gt;% 
        arrange(desc(total_neg)) 
print(wordCountDoc_neg %&gt;% top_n(5))</code></pre>
<pre class="whiteb"><code>## # A tibble: 5 x 2
##   word      total_neg
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 breakfast      1075
## 2 small           871
## 3 staff           703
## 4 rooms           637
## 5 bed             586</code></pre>
<pre class="r blue"><code>#wordcloud
wordcloud(words = wordCountDoc_neg$word, 
          freq = wordCountDoc_neg$total_neg, 
          max.words = 150,
          min.freq = 140,
          scale = c(3, 0.5), 
          random.order = FALSE,
          rot.per = 0.35,
          colors = c(&quot;#ccebc5&quot;, &quot;#7bccc4&quot;, &quot;#7fbf7b&quot;,&quot;#4eb3d3&quot;,&quot;#8c6bb1&quot;,&quot;#810f7c&quot;))+
    title(main = &quot;Most Frequent Words in Negative Reviews&quot;, col.main = &quot;#810f7c&quot;, size = 8, family=&quot;Montserrat&quot;, face = &quot;bold&quot;)</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-17-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="whiteb"><code>## integer(0)</code></pre>
</div>
</div>
<div id="hotel-reviewed-by-highest-number-of-alleged-bots" class="section level3">
<h3>Hotel reviewed by highest number of alleged bots</h3>
<pre class="r blue"><code>bots_by_hotel&lt;-duplicates%&gt;% 
  group_by(hotel_name)%&gt;%
  summarise(count=n())%&gt;%
  mutate(is_culprit=ifelse(hotel_name==&quot;H tel Concorde Montparnasse&quot;,1,0))%&gt;% #for graph fill aesthetic
  arrange(desc(count))%&gt;%
  slice(1:7) #selecting top 7 hotels for visualisation, so we arrange by desc(count) and slice the first 7
ggplot(bots_by_hotel, aes(x=reorder(hotel_name,count), y=count, fill=factor(is_culprit))) +
    geom_bar(stat=&quot;identity&quot;, alpha=0.8)+
  coord_flip()+ #flip axes to show name of hotel
theme_minimal() + #put simple theme to emnphasise the graphs
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;#043680&quot;,size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;#043680&quot;, face=&quot;plain&quot;, ,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position = &quot;none&quot;)+
    labs(title = &quot;Hotels reviewed by \nhighest number of alleged bots&quot;, subtitle= &quot;&quot;, x=&quot;Hotels with alleged use of bots&quot;, y=&quot;Count&quot;, caption=&quot;Source: https://www.kaggle.com/ployyyywa/global-hotel-chain-presence&quot;) +
  scale_y_continuous()+
  scale_fill_manual(values = c(&quot;grey80&quot;, &quot;#2FABE1&quot;))+ #specifying the colours
   geom_label(aes(label=count))</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-18-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="meaningless-reviews-vs-meaningful-reviews" class="section level3">
<h3>Meaningless reviews vs meaningful reviews</h3>
<pre class="r blue"><code>#popularity of bots
bots_by_popularity&lt;-duplicates%&gt;%
  mutate(negative_review_renew=ifelse(negative_review==&quot;No Negative&quot;|negative_review==&quot;Nothing&quot;|negative_review==&quot;nothing&quot;|negative_review==&quot;Everything&quot;,&quot;Meaningless review&quot;,&quot;Meaningful review&quot;))%&gt;% #define meaningless review and meaningful review for visualisation
  group_by(negative_review_renew)%&gt;%
  summarise(sum=n())%&gt;%
  arrange(desc(sum))%&gt;%
  mutate(is_others=ifelse(negative_review_renew==&quot;Meaningful review&quot;,1,0))%&gt;% #deprecated line, originally used for fill aesthetic colouring, but we cancelled the colouring already
  slice(1:2)
bots_graph &lt;- ggplot(bots_by_popularity, aes(x=reorder(negative_review_renew,-sum), y=sum)) +
    geom_bar(stat=&quot;identity&quot;, alpha=0.8)+
theme_minimal() +
  theme(panel.grid.major.y = element_line(color = &quot;gray60&quot;, size = 0.1),
        panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;),
        axis.line = element_line(size = 1, colour = &quot;grey80&quot;),
        axis.ticks = element_line(size = 3,colour = &quot;grey80&quot;),
        axis.ticks.length = unit(.20, &quot;cm&quot;),
        plot.title = element_text(color = &quot;#043680&quot;,size=15,face=&quot;bold&quot;, family= &quot;Montserrat&quot;),
        plot.subtitle = element_text(color = &quot;#043680&quot;, face=&quot;plain&quot;, ,size= 10,family= &quot;Montserrat&quot;),
        plot.caption = element_text(color = &quot;grey40&quot;, face=&quot;italic&quot;, ,size= 7,family= &quot;Montserrat&quot;,hjust=0),
        axis.title.y = element_text(size = 8, angle = 90, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.y=element_text(family=&quot;Montserrat&quot;, size=7),
        axis.title.x = element_text(size = 8, family=&quot;Montserrat&quot;, face = &quot;plain&quot;),
        axis.text.x=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.text=element_text(family=&quot;Montserrat&quot;, size=7),
        legend.title=element_text(family=&quot;Montserrat&quot;, size=8, face=&quot;bold&quot;),
        legend.position = &quot;none&quot;)+
    labs(title = &quot;Two-thirds of bots produce meaningless reviews&quot;, subtitle= &quot;&quot;, x=&quot;Type of review&quot;, y=&quot;Count&quot;, caption=&quot;(We define repetitive reviews as exactly one of &#39;No Negative&#39;, &#39;Nothing&#39;, &#39;nothing&#39; and &#39;Everything&#39;)&quot;) +
  scale_y_continuous()+
  scale_fill_manual(values = c(&quot;grey80&quot;))+
  geom_label(aes(label=sum),family=&quot;Montserrat&quot;, fontface=&quot;bold&quot; )
my_text1r &lt;- &quot;No Negative, \nNothing, \nnothing, &amp; \nEverything&quot;
my_grobr1 &lt;- grid.text(my_text1r, x=0.57,  y=0.82,gp=gpar(fontfamily=&quot;Montserrat&quot;,fontsize= 12, col=&quot;#2FABE1&quot;, fontface=&quot;bold&quot;))</code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-19-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r blue"><code> bots_graph + annotation_custom(my_grobr1) </code></pre>
<p><img src="/portfolio/project-13_files/figure-html/unnamed-chunk-19-2.png" width="648" style="display: block; margin: auto;" /></p>
<p>Thank you!</p>
</div>

          </div>
          <div class="site-project-single-image">
            
          </div>
          
          <div class="site-project-single-action">
            <a href="/portfolio/project-10/">
              <span class="link-area">
                <span data-text="Next Project">
                  Next Project
                </span>
              </span>
              <img src="/images/to-top.svg" alt="next project">
            </a>
          </div>
          
        </div>
      </div>
    </div>
  </div>
</section>


  
  <section class="site-cta" style='background-image: url("/images/backgrounds/cta-background.jpg");'>
    <div class="container">
      <div class="row">
        <div class="col-12 text-center">
          <h1 class="site-cta-title">Contact me</h1>
          <ul class="site-cta-buttons">
            <li>
              <a href="/contact" class="btn btn-secondary">
                <span class="btn-area">
                  <span data-text="Send an email">
                    Send an email
                  </span>
                </span>
              </a>
            </li>
            <li>
              <a href="/portfolio" class="btn btn-primary">
                <span class="btn-area">
                  <span data-text="See more portfolio">
                    See more portfolio
                  </span>
                </span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>
  



        </main><footer class="site-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="site-footer-logo"><a href="/"><img src="/images/logo-footer.png" alt="logo-footer"></a></div>
      </div>
      
      <div class="col-lg-3 col-md-6">
        <div class="site-footer-widget">
          <h5 class="site-footer-widget-title">Contact Info</h5>
          <p class="site-footer-widget-description">
            Regent's Park, London NW1 4SA
            <br>
            <a href="tel:&#43;447762727403">&#43;447762727403</a>
            <br>
            <a href="mailto:aprawda.mam2021@london.edu">aprawda.mam2021@london.edu</a>
          </p>
        </div>
      </div>
      
      
      
      <div class="col-lg-2 col-md-6">
        <div class="site-footer-widget">
          <h5 class="site-footer-widget-title">Social Media</h5>
          <ul class="site-footer-widget-links">
            
              <li><a href="https://www.linkedin.com/in/agnieszka-prawda/">Linkedin</a></li>
            
          </ul>
        </div>
      </div>
      
      
      <div class="col-lg-2 col-12">
        <a href="#top" class="site-footer-widget-top">
          <img src="/images/to-top.svg" alt="back-to-top">
          <p>
            I want to 
            <br>
            visit again
          </p>
        </a>
      </div>
    </div>
  </div>
</footer>


<script src="/js/formhandler.min.js"></script>

<script src="/js/vendor.min.js"></script>

<script src="/js/script.min.js"></script></body>
</html>
